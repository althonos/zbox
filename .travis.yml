sudo: false
language: python
cache:
  directories:
  - "$CARGO_HOME"
  - "$HOME/.pip/cache"
  - "$HOME/libsodium"
  - "build/temp.linux-x86_64-3.6/bindings.rust.zbox/release/deps/"

env:
  global:
  - CARGO_HOME="$HOME/.cargo"
  - PATH="$PATH:$CARGO_HOME/bin"
  - PKG_CONFIG_PATH="$PKG_CONFIG_PATH:$HOME/libsodium/lib/pkgconfig"

python:
- '2.7'
- '3.5'
- '3.6'
- nightly

before_install:
- curl https://sh.rustup.rs -sSf | sh -s -- -y --default-toolchain nightly
- curl https://raw.githubusercontent.com/google/hat-backup/master/travis-install-libsodium.sh | sh -s
- pip install -U setuptools setuptools-rust docutils Pygments

install:
- python setup.py build
- pip install .

script:
- python setup.py test

before_deploy:
- python setup.py check -rms sdist

notifications:
  email:
  - althonosdev@gmail.com
